function setTable() {
	if (table) {
		table.destroy();
	}
	table = jQuery('#' + idTable)
		.DataTable({
			scrollY: tableConfig.height ? tableConfig.height + 'px' : 'auto',
			autoWidth: false,
			scroller: true,
			scrollX: true,
			paging: false,
			searching: true,
			drawCallback: function () {
				setSelected();
			},
			language: {
				emptyTable: tableConfig.errorMsg
					? getMssgError()
					: 'Ningun ' +
					  (tableConfig && tableConfig.name ? tableConfig.name.toLowerCase() : '') +
					  ' para mostrar',
				infoEmpty: '',
				sZeroRecords: 'Ningun ' + tableConfig.name + ' con esos filtros.',
				search: ''
			},
			dom: 'Bfrtip',
			buttons: tableConfig.buttons ? ['copy', 'excel', 'csv', 'pdf', 'print'] : [],
			columns: parseColumns(),
			createdRow: function (row, data, dataIndex) {
				jQuery(row).attr('id', data.ID);
				jQuery(row).attr('class', data.IsSameParty ? 'same-party-row' : '');
				jQuery(row).attr('class', data.HaveError ? 'error-row' : '');
			}
		})
		.off('click')
		.on('click', 'button', function (e) {
			e.stopPropagation();
			var btnClass = jQuery(this).attr('class');
			var data = table.row(jQuery(this).parents('tr')).data();
			if (data.Action) {
				data.Action.clickHandler(data, btnClass);
			}
		})
		.on('click', 'tr', function () {
			if (tableConfig.selectable) {
				selectObject(table.row(this).data());
			}
		});

	table && table.clear().rows.add(tableItems);

	table.order([
		tableConfig.filters && tableConfig.filters.orderSort ? tableConfig.filters.orderSort : 0,
		tableConfig.filters && tableConfig.filters.sortType ? tableConfig.filters.sortType : 'desc'
	]);
	setColumnsWidth();
}

function setColumnsWidth() {
	for (var i = 0; i < tableConfig.columns.length; i++) {
		let c = tableConfig.columns[i];
		if (c.minWidth) {
			let wrapperTableId = '#' + idTable + '_wrapper';
			jQuery(wrapperTableId + ' th:eq(' + i + '),' + wrapperTableId + ' td:eq(' + i + ')').css(
				'min-width',
				c.minWidth + 'px'
			);
		}
	}
}

function getMssgError() {
	return (
		'<div class="error-wrapper"> <div class="error-content"> <i class="fa fa-exclamation"></i> <span class="text-danger">' +
		tableConfig.errorMsg +
		'</span> </div> </div>'
	);
}

function filterTable(str) {
	table && table.search(str);
	searchMatchs = table.page.info().recordsDisplay;
	table && table.draw();
}

function clickButtonAction(type) {
	jQuery('.buttons-' + type).click();
}
